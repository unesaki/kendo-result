<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.kendo.repository.UserRepository">

    <!-- メールアドレスによるユーザー数のカウント -->
    <select id="countByEmail" parameterType="string" resultType="int">
        SELECT COUNT(*)
        FROM users
        WHERE email = #{email}
    </select>

    <!-- ユーザーの新規登録 -->
    <insert id="insert" parameterType="com.example.kendo.entity.UserEntity" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO users (
            username,
            email,
            password,
            created_at,
            updated_at
        ) VALUES (
            #{username},
            #{email},
            #{password},
            #{createdAt},
            #{updatedAt}
        )
    </insert>
    
    <select id="selectLastInsertId" resultType="long">
    SELECT LAST_INSERT_ID()
</select>
    
    <select id="findByEmail" parameterType="string" resultType="com.example.kendo.entity.UserEntity">
    SELECT
        id,
        username,
        email,
        password,
        created_at,
        updated_at
    FROM users
    WHERE email = #{email}
</select>


</mapper>
